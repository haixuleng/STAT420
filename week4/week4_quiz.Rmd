---
title: "week4 quiz"
author: "Haixu Leng"
date: "6/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Q1:** Consider testing for significance of regression in a multiple linear regression model with 9 predictors and 30 observations. If the value of the $F$ test statistic is 2.4, what is the p-value of this test?

**A:**

```{r}
p = 9 + 1
n = 30
pf(2.4, p - 1, n - p, lower.tail = FALSE)
```

**Q2:** What is the p-value for testing $H_0:\beta_1=0, vs \ H1: \beta_1 \neq 0$ in a multiple linear regression model with 5 predictors and 20 observations if the value of the t test statistic is -1.3? 

```{r}
p = 6
n = 20
pt(-1.3, n - p) * 2
```
**Q3:** Consider the true model

\[
Y = 3 + 2x_1 + 0.5x_2 + 5x_3 + \epsilon
\]

where $\epsilon \sim N(0, \sigma^2 = 9)$

**A:**
```{r}
set.seed(42)
x_values = data.frame(
  x0 = rep(1,15),
  x1 = runif(15),
  x2 = runif(15),
  x3 = runif(15)
)
n = 15
p = 3 + 1
x = data.matrix(x_values)
C = solve(t(x)%*%x)
C
sqrt(C[3, 3]) * 3
```

**Q4:** For Questions 4-11, use the swiss dataset, which is built into R.
Fit a multiple linear regression model with Fertility as the response and the remaining variables as predictors. You should use ?swiss to learn about the background of this dataset.

**A:**

```{r}
swiss_model = lm(Fertility ~., data = swiss)

beta = as.vector(summary(swiss_model)$coef[, "Estimate"])
x = c(1, 54, 23, 13, 60, 24)

predict(swiss_model, newdata = data.frame(Agriculture = c(54),
                                          Examination = c(23),
                                          Education = c(13),
                                          Catholic = c(60),
                                          Infant.Mortality = c(24)))


confint(swiss_model, parm = "Catholic", level = 0.99)

summary(swiss_model)$coef["Examination", "Pr(>|t|)"]

predict(swiss_model, newdata = data.frame(Agriculture = c(40),
                                          Examination = c(28),
                                          Education = c(10),
                                          Catholic = c(42),
                                          Infant.Mortality = c(27)),
        interval = c("confidence"), level = 0.95)

predict(swiss_model, newdata = data.frame(Agriculture = c(40),
                                          Examination = c(28),
                                          Education = c(10),
                                          Catholic = c(42),
                                          Infant.Mortality = c(27)),
        interval = "prediction", level = 0.95)

summary(swiss_model)$fstatistic

pf(19.76106, 5, 41, lower.tail = FALSE)

swiss_model_3 = lm(Fertility ~ Education + Catholic + Infant.Mortality, data = swiss)
anova(swiss_model_3, swiss_model)
```

